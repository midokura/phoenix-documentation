<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-v1.1 docs-doc-page docs-doc-id-service-operator/DEPLOYMENT" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Deployment Scripts | Midokura Phoenix</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://midokura.github.io/phoenix-documentation/img/phoenix.svg"><meta data-rh="true" name="twitter:image" content="https://midokura.github.io/phoenix-documentation/img/phoenix.svg"><meta data-rh="true" property="og:url" content="https://midokura.github.io/phoenix-documentation/docs/v1.1/service-operator/DEPLOYMENT"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v1.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v1.1"><meta data-rh="true" name="docsearch:version" content="v1.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v1.1"><meta data-rh="true" property="og:title" content="Deployment Scripts | Midokura Phoenix"><meta data-rh="true" name="description" content="This guide walks you through deploying GPU infrastructure clusters using containerized Ansible automation."><meta data-rh="true" property="og:description" content="This guide walks you through deploying GPU infrastructure clusters using containerized Ansible automation."><link data-rh="true" rel="icon" href="/phoenix-documentation/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://midokura.github.io/phoenix-documentation/docs/v1.1/service-operator/DEPLOYMENT"><link data-rh="true" rel="alternate" href="https://midokura.github.io/phoenix-documentation/docs/v1.1/service-operator/DEPLOYMENT" hreflang="en"><link data-rh="true" rel="alternate" href="https://midokura.github.io/phoenix-documentation/docs/v1.1/service-operator/DEPLOYMENT" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Service Operator","item":"https://midokura.github.io/phoenix-documentation/docs/v1.1/category/service-operator"},{"@type":"ListItem","position":2,"name":"Deployment Scripts","item":"https://midokura.github.io/phoenix-documentation/docs/v1.1/service-operator/DEPLOYMENT"}]}</script><link rel="alternate" type="application/rss+xml" href="/phoenix-documentation/blog/rss.xml" title="Midokura Phoenix RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/phoenix-documentation/blog/atom.xml" title="Midokura Phoenix Atom Feed"><link rel="stylesheet" href="/phoenix-documentation/assets/css/styles.35836ae5.css">
<script src="/phoenix-documentation/assets/js/runtime~main.7e9489e6.js" defer="defer"></script>
<script src="/phoenix-documentation/assets/js/main.90b35325.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/phoenix-documentation/img/logo.png"><link rel="preload" as="image" href="/phoenix-documentation/img/logo-midokura.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/phoenix-documentation/"><div class="navbar__logo"><img src="/phoenix-documentation/img/logo.png" alt="Midokura Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/phoenix-documentation/img/logo.png" alt="Midokura Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Phoenix Documentation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/phoenix-documentation/docs/v1.1/category/service-operator">Docs</a><a class="navbar__item navbar__link" href="/phoenix-documentation/blog">Release Notes</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" sidebarid="tutorialSidebar" href="/phoenix-documentation/docs/v1.1/service-operator/DEPLOYMENT">v1.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/phoenix-documentation/docs/service-operator/DEPLOYMENT">v1.5</a></li><li><a class="dropdown__link" href="/phoenix-documentation/docs/v1.4/service-operator/DEPLOYMENT">v1.4</a></li><li><a class="dropdown__link" href="/phoenix-documentation/docs/v1.3/service-operator/DEPLOYMENT">v1.3</a></li><li><a class="dropdown__link" href="/phoenix-documentation/docs/v1.2/service-operator/DEPLOYMENT">v1.2</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/phoenix-documentation/docs/v1.1/service-operator/DEPLOYMENT">v1.1</a></li><li><a class="dropdown__link" href="/phoenix-documentation/docs/v1.0/service-operator/DEPLOYMENT">v1.0</a></li></ul></div><a href="https://github.com/jimken-mido/foo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/phoenix-documentation/docs/v1.1/category/service-operator"><span title="Service Operator" class="categoryLinkLabel_W154">Service Operator</span></a><button aria-label="Collapse sidebar category &#x27;Service Operator&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.1/service-operator/intro"><span title="Service Operator Documentation" class="linkLabel_WmDU">Service Operator Documentation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.1/service-operator/CEPH_SETUP"><span title="Setup Ceph - Generic" class="linkLabel_WmDU">Setup Ceph - Generic</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/phoenix-documentation/docs/v1.1/service-operator/DEPLOYMENT"><span title="Deployment Scripts" class="linkLabel_WmDU">Deployment Scripts</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.1/service-operator/GHCR_AUTHENTICATION"><span title="GitHub Container Registry (GHCR) Authentication" class="linkLabel_WmDU">GitHub Container Registry (GHCR) Authentication</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.1/service-operator/GOOGLE_SSO_SETUP"><span title="Google SSO Setup Guide" class="linkLabel_WmDU">Google SSO Setup Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.1/service-operator/IAAS_CONSOLE_CONFIGURATION"><span title="IaaS Console Configuration" class="linkLabel_WmDU">IaaS Console Configuration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.1/service-operator/INSTALL_BAREMETAL_NODE"><span title="Ironic Baremetal Node Creation" class="linkLabel_WmDU">Ironic Baremetal Node Creation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.1/service-operator/NETWORK_CONTROL_NODE_SETUP"><span title="Network Control Node Setup" class="linkLabel_WmDU">Network Control Node Setup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.1/service-operator/OBSERVABILITY_ALERTS"><span title="Observability Alerts" class="linkLabel_WmDU">Observability Alerts</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.1/service-operator/OBSERVABILITY_DASHBOARDS"><span title="Observability Dashboards" class="linkLabel_WmDU">Observability Dashboards</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.1/service-operator/OPERATOR_API_GUIDE"><span title="Operator API Usage Guide" class="linkLabel_WmDU">Operator API Usage Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.1/service-operator/OS_REQUIREMENTS"><span title="OS Requirements" class="linkLabel_WmDU">OS Requirements</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.1/service-operator/VPN_CONFIGURATION"><span title="VPN Configuration for Tenant Users" class="linkLabel_WmDU">VPN Configuration for Tenant Users</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Midokura Phoenix<!-- --> <b>v1.1</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/phoenix-documentation/docs/service-operator/DEPLOYMENT">latest version</a></b> (<!-- -->v1.5<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/phoenix-documentation/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/phoenix-documentation/docs/v1.1/category/service-operator"><span>Service Operator</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Deployment Scripts</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v1.1</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Deployment Scripts</h1></header>
<p>This guide walks you through deploying GPU infrastructure clusters using containerized Ansible automation.
The deployment scripts handle the complete setup of OpenStack, management clusters, and observability stack on physical infrastructure.</p>
<p><strong>Getting the Release Package:</strong></p>
<p>Download the latest release from the provided URL</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="before-you-start">Before You Start<a href="#before-you-start" class="hash-link" aria-label="Direct link to Before You Start" title="Direct link to Before You Start" translate="no">​</a></h2>
<p>Before running the deployment, you need to prepare several things. We&#x27;ll go through them one by one.</p>
<p><strong>Note:</strong> All default paths below can be customized using CLI arguments (see <a href="#options-and-configuration" class="">Options and Configuration</a>).</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="prerequisites-checklist">Prerequisites Checklist<a href="#prerequisites-checklist" class="hash-link" aria-label="Direct link to Prerequisites Checklist" title="Direct link to Prerequisites Checklist" translate="no">​</a></h3>
<p>Quick verification checklist. Click any item for detailed setup instructions below.</p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <strong>Container Runtime</strong> - Podman or Docker installed → <a href="#container-runtime" class="">Details</a></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <strong>Registry Authentication</strong> - Authenticated to ghcr.io for pulling private images → <a href="#registry-authentication" class="">Details</a></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <strong>Vault Password</strong> - Know the password (will be prompted) → <a href="#vault-password" class="">Details</a></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <strong>SSH Keys</strong> - Have controller access key in <code>~/.ssh/</code> → <a href="#ssh-keys" class="">Details</a></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <strong>Ceph Keyrings</strong> - three keyring files in <code>./keyrings/</code> (cinder, cinder-backup, glance) → <a href="#ceph-keyrings" class="">Details</a></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <strong>Disk Space</strong> - 30 GB free in <code>~/.cache/gpu-infrastructure/</code> for VM images → <a href="#vm-images" class="">Details</a></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <strong>Inventory File</strong> - <code>./inventory.yml</code> present and valid → <a href="#inventory-file" class="">Details</a></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="container-runtime">Container Runtime<a href="#container-runtime" class="hash-link" aria-label="Direct link to Container Runtime" title="Direct link to Container Runtime" translate="no">​</a></h3>
<ul>
<li class=""><strong>What it is:</strong> Container runtime (Podman or Docker) to run the deployment automation</li>
<li class=""><strong>Purpose:</strong> Runs the Ansible container with all deployment tools pre-installed</li>
<li class=""><strong>Where to get it:</strong> Install <a href="https://podman.io/docs/installation" target="_blank" rel="noopener noreferrer" class="">Podman</a> or <a href="https://docs.docker.com/get-started/get-docker/" target="_blank" rel="noopener noreferrer" class="">Docker</a></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="registry-authentication">Registry Authentication<a href="#registry-authentication" class="hash-link" aria-label="Direct link to Registry Authentication" title="Direct link to Registry Authentication" translate="no">​</a></h3>
<ul>
<li class="">
<p><strong>What it is:</strong> GitHub Container Registry (GHCR) credentials for pulling private container images</p>
</li>
<li class="">
<p><strong>Purpose:</strong> Required for deployment OSt and IaaS Console / Observability containers</p>
</li>
<li class="">
<p><strong>Setup steps:</strong></p>
<ol>
<li class="">
<p>Create GitHub Personal Access Token with <code>read:packages</code> scope (<a href="https://github.com/settings/tokens" target="_blank" rel="noopener noreferrer" class="">Token Settings</a>)</p>
</li>
<li class="">
<p>Authenticate to registry:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export CR_PAT=YOUR_TOKEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo $CR_PAT | podman login ghcr.io -u USERNAME --password-stdin</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Encrypt token: <code>ansible-vault encrypt_string &#x27;ghp_YourToken&#x27; --name &#x27;ghcr_pat&#x27; --ask-vault-password</code></p>
</li>
<li class="">
<p>Add to <code>inventory.yml</code>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">all</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">vars</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">iaas_console</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">ghcr_user</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;your-github-username&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">ghcr_pat</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token tag" style="color:#00009f">!vault</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        $ANSIBLE_VAULT;1.1;AES256</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        ... encrypted token ...</span><br></span></code></pre></div></div>
</li>
</ol>
</li>
<li class="">
<p><strong>Important:</strong> Always encrypt PAT in inventory.yml, never commit unencrypted secrets</p>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="vault-password">Vault Password<a href="#vault-password" class="hash-link" aria-label="Direct link to Vault Password" title="Direct link to Vault Password" translate="no">​</a></h3>
<ul>
<li class=""><strong>What it is:</strong> Password to decrypt and encrypt configuration files</li>
<li class=""><strong>Purpose:</strong> Decrypts secrets in <code>inventory.yml</code> and other encrypted configuration files</li>
<li class=""><strong>How it works:</strong>
<ol>
<li class="">The script prompts you to enter the password interactively at the beginning</li>
<li class="">It temporarily stores the password in <code>~/vault-key.txt</code> during execution</li>
<li class="">The file is automatically removed when the script completes</li>
</ol>
</li>
<li class=""><strong>What you need:</strong> Just know the password - the script handles the file creation and cleanup</li>
<li class=""><strong>Important:</strong> The local file <code>~/vault-key.txt</code> will be mounted in the container as <code>/secrets/vault-key.txt</code> read-only file</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="ssh-keys">SSH Keys<a href="#ssh-keys" class="hash-link" aria-label="Direct link to SSH Keys" title="Direct link to SSH Keys" translate="no">​</a></h3>
<ul>
<li class=""><strong>What it is:</strong> SSH private keys to access cluster nodes</li>
<li class=""><strong>Location:</strong> <code>~/.ssh/</code> directory and <code>~/.ssh/id_ed25519</code> as default private key</li>
<li class=""><strong>Purpose:</strong>
<ul>
<li class="">Used for: Deploying OpenStack on physical controller nodes and accessing management VMs (management cluster, observability services)</li>
<li class="">Variable in inventory.yml: <code>ansible_ssh_private_key_file</code></li>
<li class="">Test access: <code>ssh -i ~/.ssh/management-key.pem root@your-controller-hostname</code></li>
<li class="">Create the keypair if needed: <code>ssh-keygen -t ed25519 -f ~/.ssh/management-key.pem</code></li>
</ul>
</li>
<li class=""><strong>Important:</strong> Always use <code>~/.ssh/</code> paths in your <code>inventory.yml</code>. Your <code>~/.ssh/</code> directory is automatically mounted inside the container as a read-only directory</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="ceph-keyrings">Ceph Keyrings<a href="#ceph-keyrings" class="hash-link" aria-label="Direct link to Ceph Keyrings" title="Direct link to Ceph Keyrings" translate="no">​</a></h3>
<ul>
<li class="">
<p><strong>What it is:</strong> Authentication credentials for Ceph storage backend</p>
</li>
<li class="">
<p><strong>Location:</strong> <code>./keyrings/</code> directory</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">keyrings/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── ceph.client.cinder-backup.keyring</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── ceph.client.cinder.keyring</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── ceph.client.glance.keyring</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>Purpose:</strong> Allows OpenStack services (Cinder, Glance, Nova) to access Ceph storage</p>
</li>
<li class="">
<p><strong>Inventory configuration:</strong> Your <code>inventory.yml</code> should reference these files:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">ceph_cinder_backup_keyring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{ playbook_dir }}/../../keyrings/ceph.client.cinder-backup.keyring&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">ceph_cinder_keyring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{ playbook_dir }}/../../keyrings/ceph.client.cinder.keyring&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">ceph_glance_keyring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{ playbook_dir }}/../../keyrings/ceph.client.glance.keyring&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">ceph_nova_keyring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{ playbook_dir }}/../../keyrings/ceph.client.cinder.keyring&quot;</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>Important:</strong> The local <code>./keyrings</code> will be mounted inside the container as <code>/keyrings</code> read-only directory.</p>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="vm-images">VM Images<a href="#vm-images" class="hash-link" aria-label="Direct link to VM Images" title="Direct link to VM Images" translate="no">​</a></h3>
<ul>
<li class=""><strong>What it is:</strong> VM images (Cirros, Ubuntu, Phoenix with CUDA) for provisioning VMs and BMs</li>
<li class=""><strong>Location:</strong> <code>~/.cache/gpu-infrastructure/images</code> (default)</li>
<li class=""><strong>Purpose:</strong> First deployment downloads images, converts them from qcow2 to raw format, and uploads to OpenStack Glance. Subsequent deployments reuse cached images</li>
<li class=""><strong>Requirements:</strong>
<ul>
<li class="">~30 GB free disk space</li>
<li class="">Internet connectivity during first deployment to download the images if needed</li>
</ul>
</li>
<li class=""><strong>Optional:</strong> Pre-populate the cache directory if you have the images available offline</li>
<li class=""><strong>Important:</strong> Your <code>~/.cache/gpu-infrastructure/</code> directory is automatically mounted inside the container at <code>/root/.cache/gpu-infrastructure</code> as a writable directory</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="inventory-file">Inventory File<a href="#inventory-file" class="hash-link" aria-label="Direct link to Inventory File" title="Direct link to Inventory File" translate="no">​</a></h3>
<ul>
<li class=""><strong>What it is:</strong> Configuration file defining OpenStack cloud connection and resources (networks, flavors, images, VMs)</li>
<li class=""><strong>Location:</strong> <code>./inventory.yml</code> in the release-assets directory</li>
<li class=""><strong>Template:</strong> See <code>inventory.example.yml</code> for an example with configuration options</li>
<li class=""><strong>Purpose:</strong> Tells Ansible how to connect to your OpenStack deployment and what resources to provision.</li>
<li class=""><strong>Important:</strong> Your <code>./inventory.yml</code> file is automatically mounted inside the container at <code>/inventory.yml</code> as a read-only file</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="quick-start">Quick Start<a href="#quick-start" class="hash-link" aria-label="Direct link to Quick Start" title="Direct link to Quick Start" translate="no">​</a></h2>
<p><strong>Note:</strong> All commands below assume you&#x27;re in the <code>release-assets/</code> directory.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="first-time-setup">First-Time Setup<a href="#first-time-setup" class="hash-link" aria-label="Direct link to First-Time Setup" title="Direct link to First-Time Setup" translate="no">​</a></h3>
<ol>
<li class="">Download the release package from the provided URL</li>
<li class="">Extract the tar.gz archive into a folder called <code>release-assets</code>:
<code>mkdir release-assets &amp;&amp; tar -xzf release-assets-*.tar.gz -C release-assets</code></li>
<li class="">Change to release directory: <code>cd release-assets</code></li>
<li class="">Verify checksums: <code>sha256sum -c SHA256SUMS</code></li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="complete-deployment">Complete Deployment<a href="#complete-deployment" class="hash-link" aria-label="Direct link to Complete Deployment" title="Direct link to Complete Deployment" translate="no">​</a></h3>
<ol>
<li class="">Run master script: <code>./scripts/main.sh</code></li>
<li class="">Enter vault password when prompted</li>
<li class="">Wait for deployment to complete (1-2 hours)</li>
<li class="">Review logs in <code>logs/</code></li>
<li class="">Verify services are running (see below)</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="verify-deployment-success">Verify Deployment Success<a href="#verify-deployment-success" class="hash-link" aria-label="Direct link to Verify Deployment Success" title="Direct link to Verify Deployment Success" translate="no">​</a></h3>
<p>After deployment completes, verify that all services are running correctly:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Check that deployment completed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tail -50 logs/main-*.log | grep -i &quot;success\\|complete\\|failed&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Verify OpenStack services (if OpenStack was deployed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/main.sh --shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source &lt;(ansible-vault view --vault-password-file /secrets/vault-key.txt /infra-management/config/admin-openrc.sh)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openstack server list  # Should show VMs if management cluster/observability were deployed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Verify management cluster (if management cluster was deployed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export KUBECONFIG=/infra-management/kubeconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get nodes  # Should show Ready status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods -A  # Should show Running pods</span><br></span></code></pre></div></div>
<p><strong>Success indicators:</strong></p>
<ul>
<li class="">✅ All Ansible tasks completed without failures</li>
<li class="">✅ Management cluster nodes show &quot;Ready&quot; status</li>
<li class="">✅ All pods show &quot;Running&quot; or &quot;Completed&quot; status</li>
<li class="">✅ No error messages in logs</li>
</ul>
<p><strong>If you see failures:</strong></p>
<ul>
<li class="">Check the logs in <code>logs/main-*.log</code> for error details</li>
<li class="">See <a href="#partial-execution" class="">Partial Execution</a> below to retry specific steps</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="partial-execution">Partial Execution<a href="#partial-execution" class="hash-link" aria-label="Direct link to Partial Execution" title="Direct link to Partial Execution" translate="no">​</a></h3>
<p>Use <code>--tags</code> and <code>--skip-tags</code> to control which steps run.
See (<a href="#available-ansible-tags" class="">full list</a>) of available tags for more details.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Run specific components</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/main.sh --tags openstack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/main.sh --tags openstack,provision-demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Skip specific components</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/main.sh --skip-tags observability</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Combine with script flags and other options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/main.sh --skip-load-container --inventory custom.yml --tags management -vvv</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="options-and-configuration">Options and Configuration<a href="#options-and-configuration" class="hash-link" aria-label="Direct link to Options and Configuration" title="Direct link to Options and Configuration" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="configuration-methods">Configuration Methods<a href="#configuration-methods" class="hash-link" aria-label="Direct link to Configuration Methods" title="Direct link to Configuration Methods" translate="no">​</a></h3>
<p><strong>Priority order:</strong> CLI arguments &gt; Environment variables &gt; Defaults (CLI args recommended)</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Example: CLI arguments override environment variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export INVENTORY=old.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/main.sh --inventory new.yml  # Uses new.yml</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="script-specific-options">Script-specific Options<a href="#script-specific-options" class="hash-link" aria-label="Direct link to Script-specific Options" title="Direct link to Script-specific Options" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="mainsh">main.sh<a href="#mainsh" class="hash-link" aria-label="Direct link to main.sh" title="Direct link to main.sh" translate="no">​</a></h4>
<p>These control the behavior of the main deployment script:</p>
<ul>
<li class=""><code>--shell</code> - Open interactive shell in container (skips deployment)</li>
<li class=""><code>--skip-load-container</code> - Skip container loading step</li>
<li class=""><code>--help</code> - Show help message</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="load-containersh">load-container.sh<a href="#load-containersh" class="hash-link" aria-label="Direct link to load-container.sh" title="Direct link to load-container.sh" translate="no">​</a></h4>
<p>These control the container image loading (one-time setup):</p>
<ul>
<li class=""><code>--image-file PATH</code> - Path to container image tar file (default: <code>./container-image.tar</code>)</li>
<li class=""><code>--help</code> - Show help message</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="common-configuration-options">Common Configuration Options<a href="#common-configuration-options" class="hash-link" aria-label="Direct link to Common Configuration Options" title="Direct link to Common Configuration Options" translate="no">​</a></h3>
<p>These options are shared across all scripts and can be specified via CLI arguments or environment variables:</p>
<table><thead><tr><th>CLI Argument</th><th>Environment Variable</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>-i, --inventory PATH</code></td><td><code>INVENTORY</code></td><td><code>./inventory.yml</code></td><td>Ansible inventory file</td></tr><tr><td><code>--vault-file PATH</code></td><td><code>VAULT_FILE</code></td><td><code>~/vault-key.txt</code></td><td>Vault password file</td></tr><tr><td><code>--ssh-dir PATH</code></td><td><code>SSH_DIR</code></td><td><code>~/.ssh</code></td><td>SSH directory path</td></tr><tr><td><code>--cache-dir PATH</code></td><td><code>CACHE_DIR</code></td><td><code>~/.cache/gpu-infrastructure</code></td><td>Cache directory for images</td></tr><tr><td><code>--keyrings-dir PATH</code></td><td><code>KEYRINGS_DIR</code></td><td><code>./keyrings</code></td><td>Ceph keyrings directory</td></tr><tr><td><code>--assets-dir PATH</code></td><td><code>ASSETS_DIR</code></td><td><code>./assets/</code></td><td>Generated assets directory</td></tr></tbody></table>
<p>These are configured via environment variables only:</p>
<ul>
<li class=""><code>LOG_DIR</code> - Log directory (default: <code>./logs</code>)</li>
</ul>
<p>Container image:</p>
<ul>
<li class=""><code>IMAGE_NAME</code> - Container image name (default: <code>ghcr.io/midokura/gpu-infra-ansible</code>)</li>
<li class=""><code>IMAGE_TAG</code> - Container image tag (default: <code>release</code>)</li>
</ul>
<p>All other arguments are passed directly to <code>ansible-playbook</code>:</p>
<ul>
<li class=""><code>--tags TAG1,TAG2</code> - Run specific tagged steps (<a href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_tags.html#selecting-or-skipping-tags-when-you-run-a-playbook" target="_blank" rel="noopener noreferrer" class="">docs</a>)</li>
<li class=""><code>--skip-tags TAG1,TAG2</code> - Skip specific tagged steps</li>
<li class=""><code>--extra-vars KEY=VALUE</code> - Pass additional variables to playbook (for example, <code>--extra-vars &quot;debug=true&quot;</code>) (<a href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_variables.html#defining-variables-at-runtime" target="_blank" rel="noopener noreferrer" class="">docs</a>)</li>
<li class=""><code>-v</code>, <code>-vv</code>, <code>-vvv</code> - Verbose output</li>
<li class="">Any other ansible-playbook flags</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="environment-variables">Environment Variables<a href="#environment-variables" class="hash-link" aria-label="Direct link to Environment Variables" title="Direct link to Environment Variables" translate="no">​</a></h3>
<p>All scripts use common environment variables defined in <code>common.sh</code>:</p>
<p><strong>Input parameters:</strong></p>
<ul>
<li class=""><code>VAULT_FILE</code> - Vault password file path (default: <code>~/vault-key.txt</code>)</li>
<li class=""><code>SSH_DIR</code> - SSH directory path (default: <code>~/.ssh</code>)</li>
<li class=""><code>CACHE_DIR</code> - Cache directory for images and Ansible facts (default: <code>~/.cache/gpu-infrastructure</code>)</li>
<li class=""><code>KEYRINGS_DIR</code> - Ceph keyrings directory (default: <code>./keyrings</code>)</li>
<li class=""><code>INVENTORY</code> - Ansible inventory file (default: <code>./inventory.yml</code>)</li>
</ul>
<p><strong>Output parameters:</strong></p>
<ul>
<li class=""><code>LOG_DIR</code> - Log directory (default: <code>./logs</code>)</li>
<li class=""><code>ASSETS_DIR</code> - Generated assets directory (default: <code>./assets/</code>)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="available-ansible-tags">Available Ansible Tags<a href="#available-ansible-tags" class="hash-link" aria-label="Direct link to Available Ansible Tags" title="Direct link to Available Ansible Tags" translate="no">​</a></h3>
<table><thead><tr><th>Tag</th><th>Description</th><th>Sub-tags</th></tr></thead><tbody><tr><td><code>openstack</code></td><td>Deploy OpenStack via Kolla-Ansible</td><td><code>config</code>, <code>deploy</code>, <code>provision</code>, <code>encrypt</code></td></tr><tr><td><code>management</code></td><td>Deploy management cluster</td><td><code>management-create</code>, <code>management-deploy</code></td></tr><tr><td><code>observability</code></td><td>Deploy observability stack</td><td><code>remote-metrics</code></td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="logs">Logs<a href="#logs" class="hash-link" aria-label="Direct link to Logs" title="Direct link to Logs" translate="no">​</a></h2>
<p>Deployment logs are stored in <code>logs/</code>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">logs/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── load-container-YYYYMMDD-HHMMSS.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── main-YYYYMMDD-HHMMSS.log</span><br></span></code></pre></div></div>
<p>The <code>main-YYYYMMDD-HHMMSS.log</code> contains output from all deployment steps executed in a single run.</p>
<p>Each log file contains:</p>
<ul>
<li class="">Timestamped console output</li>
<li class="">Ansible playbook execution details</li>
<li class="">Error messages and stack traces</li>
<li class="">Execution timing information</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="container-not-found">Container not found<a href="#container-not-found" class="hash-link" aria-label="Direct link to Container not found" title="Direct link to Container not found" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Check if image is loaded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">podman images | grep gpu-infra-ansible</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Load container if missing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/load-container.sh</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="vault-password-errors">Vault password errors<a href="#vault-password-errors" class="hash-link" aria-label="Direct link to Vault password errors" title="Direct link to Vault password errors" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Verify vault file exists and has correct permissions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls -l ~/vault-key.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 600 ~/vault-key.txt</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="ssh-connection-failures">SSH connection failures<a href="#ssh-connection-failures" class="hash-link" aria-label="Direct link to SSH connection failures" title="Direct link to SSH connection failures" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Verify SSH access to cluster nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh root@roquefort.bcn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh root@idiazabal.bcn</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="script-failures">Script failures<a href="#script-failures" class="hash-link" aria-label="Direct link to Script failures" title="Direct link to Script failures" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Check logs for details</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tail -f logs/*.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Run with verbose output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/main.sh -vvv</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="security-notes">Security Notes<a href="#security-notes" class="hash-link" aria-label="Direct link to Security Notes" title="Direct link to Security Notes" translate="no">​</a></h2>
<ul>
<li class="">Vault password is stored temporarily in <code>~/vault-key.txt</code></li>
<li class="">File is automatically removed when master script completes</li>
<li class="">File has restrictive permissions (600) - only readable by owner</li>
<li class="">Never commit vault password to version control</li>
<li class="">Keep vault password in a safe place</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="support">Support<a href="#support" class="hash-link" aria-label="Direct link to Support" title="Direct link to Support" translate="no">​</a></h2>
<p>For issues or questions:</p>
<ol>
<li class="">Check logs in <code>logs/</code></li>
<li class="">Review script help: <code>./scripts/&lt;script-name&gt;.sh --help</code></li>
<li class="">Run individual scripts for debugging</li>
<li class="">Contact infrastructure team</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="file-structure">File Structure<a href="#file-structure" class="hash-link" aria-label="Direct link to File Structure" title="Direct link to File Structure" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">release-assets/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── container-image.tar         # Pre-built Ansible container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── scripts/                    # Deployment scripts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── common.sh               # Shared library (sourced by all scripts)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── main.sh                 # Master orchestration script</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── load-container.sh       # Load container image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── manifest.txt                # Build manifest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── SHA256SUMS                  # Checksums</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── README.md                   # This file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Additional files needed for deployment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── inventory.yml               # Ansible inventory (environment-specific)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── keyrings/                   # Ceph client keyrings (environment-specific)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="scripts-overview">Scripts Overview<a href="#scripts-overview" class="hash-link" aria-label="Direct link to Scripts Overview" title="Direct link to Scripts Overview" translate="no">​</a></h3>
<p><strong><code>main.sh</code></strong> - Thin wrapper for deployment</p>
<ul>
<li class="">Prompts for vault password once (stored temporarily)</li>
<li class="">Loads container image (optional <code>--skip-load-container</code>)</li>
<li class="">Passes all arguments directly to <code>ansible-playbook</code></li>
<li class="">Runs master playbook (<code>main.yml</code>) with user-provided Ansible flags: <code>--tags</code>, <code>--skip-tags</code>, <code>-v</code>, etc.</li>
<li class="">Automatic cleanup of temporary files</li>
</ul>
<p><strong><code>load-container.sh</code></strong> - Load container image (one-time setup)</p>
<ul>
<li class="">Loads pre-built Ansible container from tar file</li>
<li class="">Verifies image loaded successfully</li>
</ul>
<p><strong><code>common.sh</code></strong> - Shared library for all scripts</p>
<ul>
<li class="">Container runtime detection (Podman/Docker)</li>
<li class="">Common validation functions (vault, SSH, keyrings, inventory)</li>
<li class="">Ansible playbook execution wrapper</li>
<li class="">Error handling and cleanup utilities</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="timeline">Timeline<a href="#timeline" class="hash-link" aria-label="Direct link to Timeline" title="Direct link to Timeline" translate="no">​</a></h2>
<p>Typical deployment times (may vary):</p>
<ul>
<li class="">Load container: 2-5 minutes</li>
<li class="">Deploy OpenStack: 30-60 minutes</li>
<li class="">Deploy management cluster: 5-10 minutes</li>
<li class="">Provision observability: 5-10 minutes</li>
</ul>
<p><strong>Total: ~1-2 hours</strong></p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/phoenix-documentation/docs/v1.1/service-operator/CEPH_SETUP"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Setup Ceph - Generic</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/phoenix-documentation/docs/v1.1/service-operator/GHCR_AUTHENTICATION"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">GitHub Container Registry (GHCR) Authentication</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#before-you-start" class="table-of-contents__link toc-highlight">Before You Start</a><ul><li><a href="#prerequisites-checklist" class="table-of-contents__link toc-highlight">Prerequisites Checklist</a></li><li><a href="#container-runtime" class="table-of-contents__link toc-highlight">Container Runtime</a></li><li><a href="#registry-authentication" class="table-of-contents__link toc-highlight">Registry Authentication</a></li><li><a href="#vault-password" class="table-of-contents__link toc-highlight">Vault Password</a></li><li><a href="#ssh-keys" class="table-of-contents__link toc-highlight">SSH Keys</a></li><li><a href="#ceph-keyrings" class="table-of-contents__link toc-highlight">Ceph Keyrings</a></li><li><a href="#vm-images" class="table-of-contents__link toc-highlight">VM Images</a></li><li><a href="#inventory-file" class="table-of-contents__link toc-highlight">Inventory File</a></li></ul></li><li><a href="#quick-start" class="table-of-contents__link toc-highlight">Quick Start</a><ul><li><a href="#first-time-setup" class="table-of-contents__link toc-highlight">First-Time Setup</a></li><li><a href="#complete-deployment" class="table-of-contents__link toc-highlight">Complete Deployment</a></li><li><a href="#verify-deployment-success" class="table-of-contents__link toc-highlight">Verify Deployment Success</a></li><li><a href="#partial-execution" class="table-of-contents__link toc-highlight">Partial Execution</a></li></ul></li><li><a href="#options-and-configuration" class="table-of-contents__link toc-highlight">Options and Configuration</a><ul><li><a href="#configuration-methods" class="table-of-contents__link toc-highlight">Configuration Methods</a></li><li><a href="#script-specific-options" class="table-of-contents__link toc-highlight">Script-specific Options</a></li><li><a href="#common-configuration-options" class="table-of-contents__link toc-highlight">Common Configuration Options</a></li><li><a href="#environment-variables" class="table-of-contents__link toc-highlight">Environment Variables</a></li><li><a href="#available-ansible-tags" class="table-of-contents__link toc-highlight">Available Ansible Tags</a></li></ul></li><li><a href="#logs" class="table-of-contents__link toc-highlight">Logs</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#container-not-found" class="table-of-contents__link toc-highlight">Container not found</a></li><li><a href="#vault-password-errors" class="table-of-contents__link toc-highlight">Vault password errors</a></li><li><a href="#ssh-connection-failures" class="table-of-contents__link toc-highlight">SSH connection failures</a></li><li><a href="#script-failures" class="table-of-contents__link toc-highlight">Script failures</a></li></ul></li><li><a href="#security-notes" class="table-of-contents__link toc-highlight">Security Notes</a></li><li><a href="#support" class="table-of-contents__link toc-highlight">Support</a><ul><li><a href="#file-structure" class="table-of-contents__link toc-highlight">File Structure</a></li><li><a href="#scripts-overview" class="table-of-contents__link toc-highlight">Scripts Overview</a></li></ul></li><li><a href="#timeline" class="table-of-contents__link toc-highlight">Timeline</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://midokura.com" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/phoenix-documentation/img/logo-midokura.png" alt="Midokura" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/phoenix-documentation/img/logo-midokura.png" alt="Midokura" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">©2026 Midokura</div></div></div></footer></div>
</body>
</html>