<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-v1.2 docs-doc-page docs-doc-id-service-operator/INSTALL_BAREMETAL_NODE" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Ironic Baremetal Node Creation | Midokura Phoenix</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://midokura.github.io/phoenix-documentation/img/phoenix.svg"><meta data-rh="true" name="twitter:image" content="https://midokura.github.io/phoenix-documentation/img/phoenix.svg"><meta data-rh="true" property="og:url" content="https://midokura.github.io/phoenix-documentation/docs/v1.2/service-operator/INSTALL_BAREMETAL_NODE"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v1.2"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v1.2"><meta data-rh="true" name="docsearch:version" content="v1.2"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v1.2"><meta data-rh="true" property="og:title" content="Ironic Baremetal Node Creation | Midokura Phoenix"><meta data-rh="true" name="description" content="Description"><meta data-rh="true" property="og:description" content="Description"><link data-rh="true" rel="icon" href="/phoenix-documentation/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://midokura.github.io/phoenix-documentation/docs/v1.2/service-operator/INSTALL_BAREMETAL_NODE"><link data-rh="true" rel="alternate" href="https://midokura.github.io/phoenix-documentation/docs/v1.2/service-operator/INSTALL_BAREMETAL_NODE" hreflang="en"><link data-rh="true" rel="alternate" href="https://midokura.github.io/phoenix-documentation/docs/v1.2/service-operator/INSTALL_BAREMETAL_NODE" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Service Operator","item":"https://midokura.github.io/phoenix-documentation/docs/v1.2/category/service-operator"},{"@type":"ListItem","position":2,"name":"Ironic Baremetal Node Creation","item":"https://midokura.github.io/phoenix-documentation/docs/v1.2/service-operator/INSTALL_BAREMETAL_NODE"}]}</script><link rel="alternate" type="application/rss+xml" href="/phoenix-documentation/blog/rss.xml" title="Midokura Phoenix RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/phoenix-documentation/blog/atom.xml" title="Midokura Phoenix Atom Feed"><link rel="stylesheet" href="/phoenix-documentation/assets/css/styles.b4ee8f0d.css">
<script src="/phoenix-documentation/assets/js/runtime~main.311d40ec.js" defer="defer"></script>
<script src="/phoenix-documentation/assets/js/main.0873ba80.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/phoenix-documentation/img/logo.png"><link rel="preload" as="image" href="/phoenix-documentation/img/logo-midokura.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/phoenix-documentation/"><div class="navbar__logo"><img src="/phoenix-documentation/img/logo.png" alt="Midokura Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/phoenix-documentation/img/logo.png" alt="Midokura Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Phoenix Documentation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/phoenix-documentation/docs/v1.2/category/service-operator">Docs</a><a class="navbar__item navbar__link" href="/phoenix-documentation/blog">Release Notes</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" sidebarid="tutorialSidebar" href="/phoenix-documentation/docs/v1.2/service-operator/INSTALL_BAREMETAL_NODE">v1.2</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/phoenix-documentation/docs/next/service-operator/INSTALL_BAREMETAL_NODE">Next</a></li><li><a class="dropdown__link" href="/phoenix-documentation/docs/service-operator/INSTALL_BAREMETAL_NODE">v1.6</a></li><li><a class="dropdown__link" href="/phoenix-documentation/docs/v1.5/service-operator/INSTALL_BAREMETAL_NODE">v1.5</a></li><li><a class="dropdown__link" href="/phoenix-documentation/docs/v1.4/service-operator/INSTALL_BAREMETAL_NODE">v1.4</a></li><li><a class="dropdown__link" href="/phoenix-documentation/docs/v1.3/service-operator/INSTALL_BAREMETAL_NODE">v1.3</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/phoenix-documentation/docs/v1.2/service-operator/INSTALL_BAREMETAL_NODE">v1.2</a></li><li><a class="dropdown__link" href="/phoenix-documentation/docs/v1.1/service-operator/INSTALL_BAREMETAL_NODE">v1.1</a></li><li><a class="dropdown__link" href="/phoenix-documentation/docs/v1.0/service-operator/INSTALL_BAREMETAL_NODE">v1.0</a></li></ul></div><a href="https://github.com/midokura/phoenix-documentation" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/phoenix-documentation/docs/v1.2/category/service-operator"><span title="Service Operator" class="categoryLinkLabel_W154">Service Operator</span></a><button aria-label="Collapse sidebar category &#x27;Service Operator&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.2/service-operator/intro"><span title="Service Operator Documentation" class="linkLabel_WmDU">Service Operator Documentation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.2/service-operator/CEPH_SETUP"><span title="Setup Ceph - Generic" class="linkLabel_WmDU">Setup Ceph - Generic</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.2/service-operator/DEPLOYMENT"><span title="Deployment Scripts" class="linkLabel_WmDU">Deployment Scripts</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.2/service-operator/GHCR_AUTHENTICATION"><span title="GitHub Container Registry (GHCR) Authentication" class="linkLabel_WmDU">GitHub Container Registry (GHCR) Authentication</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.2/service-operator/GOOGLE_SSO_SETUP"><span title="Google SSO Setup Guide" class="linkLabel_WmDU">Google SSO Setup Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.2/service-operator/IAAS_CONSOLE_CONFIGURATION"><span title="IaaS Console Configuration" class="linkLabel_WmDU">IaaS Console Configuration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/phoenix-documentation/docs/v1.2/service-operator/INSTALL_BAREMETAL_NODE"><span title="Ironic Baremetal Node Creation" class="linkLabel_WmDU">Ironic Baremetal Node Creation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.2/service-operator/NETWORK_CONTROL_NODE_SETUP"><span title="Network Control Node Setup" class="linkLabel_WmDU">Network Control Node Setup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.2/service-operator/OBSERVABILITY_ALERTS"><span title="Observability Alerts" class="linkLabel_WmDU">Observability Alerts</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.2/service-operator/OBSERVABILITY_DASHBOARDS"><span title="Observability Dashboards" class="linkLabel_WmDU">Observability Dashboards</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.2/service-operator/OPERATOR_API_GUIDE"><span title="Operator API Usage Guide" class="linkLabel_WmDU">Operator API Usage Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.2/service-operator/OS_REQUIREMENTS"><span title="OS Requirements" class="linkLabel_WmDU">OS Requirements</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/phoenix-documentation/docs/v1.2/service-operator/VPN_CONFIGURATION"><span title="VPN Configuration for Tenant Users" class="linkLabel_WmDU">VPN Configuration for Tenant Users</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Midokura Phoenix<!-- --> <b>v1.2</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/phoenix-documentation/docs/service-operator/INSTALL_BAREMETAL_NODE">latest version</a></b> (<!-- -->v1.6<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/phoenix-documentation/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/phoenix-documentation/docs/v1.2/category/service-operator"><span>Service Operator</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Ironic Baremetal Node Creation</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v1.2</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Ironic Baremetal Node Creation</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="description">Description<a href="#description" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description" translate="no">​</a></h2>
<p>This document covers the required infrastructure setup, the step-by-step process for registering and deploying physical servers, and reference information about Ironic&#x27;s architecture including networks, services, and deployment mechanisms.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="requirements">Requirements<a href="#requirements" class="hash-link" aria-label="Direct link to Requirements" title="Direct link to Requirements" translate="no">​</a></h2>
<ol>
<li class="">
<p>From <code>bastion0</code>, use the asset <code>./scripts/main.sh --shell</code> to get access to openstack cli.</p>
</li>
<li class="">
<p>Run <code>source &lt;(ansible-vault view --vault-password-file /secrets/vault-key.txt /infra-management/config/admin-openrc.sh)</code> to get the credentials into the environment.</p>
</li>
<li class="">
<p><strong>Create baremetal flavor</strong></p>
<p>You need to define a &quot;flavor&quot; that tells OpenStack this is for baremetal servers, not virtual machines. The special resource properties ensure OpenStack knows to provision a full physical server instead of trying to create a VM.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> openstack flavor create \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --ram 262144 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --disk 3725 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --vcpus 8 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --property resources:CUSTOM_BAREMETAL=1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --property resources:VCPU=0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --property resources:MEMORY_MB=0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --property resources:DISK_GB=0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     baremetal-flavor</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>Create the tenant network</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openstack network create \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --provider-network-type vlan \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --provider-physical-network physnet1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --provider-segment 1001 tenant-a-net \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tenant-net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openstack subnet create \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --network tenant-net \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --subnet-range 10.40.1.0/24 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --dhcp \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --allocation-pool start=10.40.1.10,end=10.40.1.254 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --gateway 10.40.1.1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --dns-nameserver 10.30.0.1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tenant-net-subnet</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>Create the tenant external router</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openstack router create tenant-ext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openstack router set tenant-ext --external-gateway external-net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openstack router add subnet tenant-ext tenant-net-subnet</span><br></span></code></pre></div></div>
</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="process">Process<a href="#process" class="hash-link" aria-label="Direct link to Process" title="Direct link to Process" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="process-overview">Process Overview<a href="#process-overview" class="hash-link" aria-label="Direct link to Process Overview" title="Direct link to Process Overview" translate="no">​</a></h3>
<p>The provisioning process involves several state transitions:</p>
<ul>
<li class=""><strong>Enroll → Manageable</strong>: Verify Ironic can communicate with the server&#x27;s BMC</li>
<li class=""><strong>Manageable → Inspecting → Manageable</strong>: Discover hardware specifications</li>
<li class=""><strong>Manageable → Available</strong>: Clean the server and prepare it for deployment</li>
<li class=""><strong>Available → Deploying → Active</strong>: Install the OS and boot into production</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="provisioning-a-node">Provisioning a Node<a href="#provisioning-a-node" class="hash-link" aria-label="Direct link to Provisioning a Node" title="Direct link to Provisioning a Node" translate="no">​</a></h3>
<p>This assumes you already have access to OpenStack from the client and you have loaded the admin credentials into the environment.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-create-the-baremetal-node">1. Create the baremetal node<a href="#1-create-the-baremetal-node" class="hash-link" aria-label="Direct link to 1. Create the baremetal node" title="Direct link to 1. Create the baremetal node" translate="no">​</a></h4>
<p>This registers the physical server with Ironic by telling it how to control the machine remotely (via IPMI), where to find the boot images, and what type of hardware resource it is.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">NODE_NAME=test-node-01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPMI_ADDRESS=&quot;192.168.7.200&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPMI_USERNAME=&quot;admin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPMI_PASSWORD=&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAC_ADDRESS=&quot;3c:fd:fe:9e:6d:d0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Update with images IDs from `openstack image list`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEPLOY_KERNEL=&quot;$(openstack image show deploy-kernel -f value -c id)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEPLOY_RAMDISK=&quot;$(openstack image show deploy-ramdisk -f value -c id)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RESOURCE_CLASS=&quot;baremetal&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openstack baremetal node create \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name $NODE_NAME \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --driver ipmi \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --network-interface neutron \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --driver-info ipmi_address=&quot;$IPMI_ADDRESS&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --driver-info ipmi_username=&quot;$IPMI_USERNAME&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --driver-info ipmi_password=&quot;$IPMI_PASSWORD&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --driver-info deploy_kernel=&quot;$DEPLOY_KERNEL&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --driver-info deploy_ramdisk=&quot;$DEPLOY_RAMDISK&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-class &quot;$RESOURCE_CLASS&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NODE_UUID=$(openstack baremetal node show $NODE_NAME -f value -c uuid)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-create-the-neutron-port">2. Create the neutron port<a href="#2-create-the-neutron-port" class="hash-link" aria-label="Direct link to 2. Create the neutron port" title="Direct link to 2. Create the neutron port" translate="no">​</a></h4>
<p>This tells Ironic which network interface (MAC address) on the physical server should be used for network booting and connects it to the proper network infrastructure.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openstack baremetal port create \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name $NODE_NAME-port \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --node $NODE_UUID \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pxe-enabled true \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --physical-network physnet1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $MAC_ADDRESS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PORT_UUID=$(openstack baremetal port show $NODE_NAME-port -f value -c uuid)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># We are not sure this is necessary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openstack baremetal port set $PORT_UUID \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --local-link-connection switch_id=&quot;b0:4f:13:7f:1d:a2&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --local-link-connection port_id=Ethernet8 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --local-link-connection switch_info=switch-name</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-put-node-into-manage-mode">3. Put node into manage mode<a href="#3-put-node-into-manage-mode" class="hash-link" aria-label="Direct link to 3. Put node into manage mode" title="Direct link to 3. Put node into manage mode" translate="no">​</a></h4>
<p>This moves the node from &quot;enroll&quot; (just registered) to &quot;manageable&quot; state—Ironic verifies it can actually talk to the server&#x27;s management controller using the IPMI credentials you provided.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openstack baremetal node manage $NODE_UUID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openstack baremetal node show $NODE_UUID -f value -c provision_state -c last_error</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-inspect-the-node">4. Inspect the node<a href="#4-inspect-the-node" class="hash-link" aria-label="Direct link to 4. Inspect the node" title="Direct link to 4. Inspect the node" translate="no">​</a></h4>
<p>This makes Ironic automatically discover the server&#x27;s hardware details (CPU, RAM, disks, etc.) by booting a special inspection image and gathering information, which then gets saved to the node&#x27;s properties.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Optionally we can set an authorized key to ssh into IPA so we can debug</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PUBLIC_IPA_SSH_KEY=&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openstack baremetal node set --driver-info kernel_append_params=&quot;nofb nomodeset vga=normal \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">console=tty0 console=ttyS0,115200n8 sshkey=\&quot;$PUBLIC_IPA_SSH_KEY\&quot;&quot; $NODE_UUID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openstack baremetal node inspect $NODE_UUID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openstack baremetal node show $NODE_UUID -c provision_state -c last_error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># You should see now more properties automatically set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openstack baremetal node show &quot;$NODE_NAME&quot; -c properties -c extra</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="5-make-node-available">5. Make node available<a href="#5-make-node-available" class="hash-link" aria-label="Direct link to 5. Make node available" title="Direct link to 5. Make node available" translate="no">​</a></h4>
<p>This moves the node to &quot;available&quot; state, meaning it&#x27;s ready to have operating systems deployed on it—Ironic will also perform automated cleaning (wiping data, resetting BIOS, etc).</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openstack baremetal node provide $NODE_UUID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openstack baremetal node show &quot;$NODE_NAME&quot; -c provision_state</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="6-create-userdata-file">6. Create userdata file<a href="#6-create-userdata-file" class="hash-link" aria-label="Direct link to 6. Create userdata file" title="Direct link to 6. Create userdata file" translate="no">​</a></h4>
<p>This prepares a cloud-init configuration file that sets up the initial password and SSH access when the operating system first boots. Customize this script with the user needs.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF &gt; /tmp/userdata.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#cloud-config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password: ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chpasswd: { expire: False }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh_pwauth: True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="7-create-the-server">7. Create the server<a href="#7-create-the-server" class="hash-link" aria-label="Direct link to 7. Create the server" title="Direct link to 7. Create the server" translate="no">​</a></h4>
<p>This actually deploys an operating system image onto the physical server using all the configuration you&#x27;ve set up—it picks the right hardware (using the baremetal flavor), installs the OS image, connects it to the tenant network, and applies the userdata.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openstack server create \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --flavor baremetal-flavor \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --image &quot;Ubuntu Server Noble LTS (Cloud) raw&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --key-name everyone \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --network tenant-net \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --user-data /tmp/userdata.txt \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --config-drive true \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  my-special-server</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="8-switch-to-the-tenant-network">8. Switch to the tenant network<a href="#8-switch-to-the-tenant-network" class="hash-link" aria-label="Direct link to 8. Switch to the tenant network" title="Direct link to 8. Switch to the tenant network" translate="no">​</a></h4>
<p>Once the server is provisioned, it will restart again, and at that moment we need to switch in Hedge Hog Switch from the provisioning network to the tenant network.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh core@control-1.bcn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete vpcattachments provision--default--gpu0--frontend--leaf0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f tenant0--default--gpu0--frontend--leaf0.yaml</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/phoenix-documentation/docs/v1.2/service-operator/IAAS_CONSOLE_CONFIGURATION"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">IaaS Console Configuration</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/phoenix-documentation/docs/v1.2/service-operator/NETWORK_CONTROL_NODE_SETUP"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Network Control Node Setup</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#description" class="table-of-contents__link toc-highlight">Description</a></li><li><a href="#requirements" class="table-of-contents__link toc-highlight">Requirements</a></li><li><a href="#process" class="table-of-contents__link toc-highlight">Process</a><ul><li><a href="#process-overview" class="table-of-contents__link toc-highlight">Process Overview</a></li><li><a href="#provisioning-a-node" class="table-of-contents__link toc-highlight">Provisioning a Node</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://midokura.com" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/phoenix-documentation/img/logo-midokura.png" alt="Midokura" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/phoenix-documentation/img/logo-midokura.png" alt="Midokura" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">©2026 Midokura</div></div></div></footer></div>
</body>
</html>